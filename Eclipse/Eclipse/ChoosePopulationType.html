<div id="choose-pop-modal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog" >
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title">Choose population type</h4>
            </div>
            <div class="modal-body container-fluid">

                <div id="addpop-single-option" style="display:none" >
                    <div class="form-group">
                        <div class="col-lg-6 col-lg-offset-3">
                            <div class="checkbox">
                                <label>
                                    <input data-value="[placeholder]" type="checkbox" checked>[placeholder]
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
                    <div id="addpop-multi-option" style="display:none" >
                        <div class="form-group ">
                            <div class="col-lg-6 col-lg-offset-3">
                                <select class="form-control">
                                    <option value="IgnoreUnknown">Ignore gray square</option>
                                    <option value="UnknownMoney">Populate gray square => Money</option>
                                    <option value="UnknownScience">Populate gray square => Science</option>
                                    <option value="UnknownMaterials">Populate gray square => Materials</option>
                                </select>
                            </div>
                        </div>
                    </div>
               


                <form id="addpop-form" class="form-horizontal " role="form">
                    
                    
            </form>
            </div>
            <div class="modal-footer">
                <button id="btn-populate" class="btn btn-primary pull-left">Add influence and populate</button>
                <button class="btn btn-default">Add influence only</button>
                <button class="btn btn-default">No influence</button>
            </div>
            </div>
        </div>

        </div>

<script type="text/javascript">
    var _args = {};
   

    function ProcessModel(model) {
        
        var html = "";
        var multiop = $('#addpop-multi-option').html();
        var singleop  = $('#addpop-single-option').html();
        for (var i = 0 ; i < model.Options.length; i++) {
            var op = model.Options[i];
            if (op.MultiOption) {
                html += multiop;
            }
            else {
                var fixedString = singleop.split('[placeholder]').join(op.SingleOption);
                html += fixedString;
            }
        }

        $('#addpop-form').html(html);

        $('#btn-populate').click(function (event) {
            var args = { Money: 0, Science: 0, Materials: 0, UnknownMoney: 0, UnknownScience: 0, UnknownMaterials: 0 , IgnoreUnknown:0};
           debugger;
           $('input').each(function (index, obj) {
                if($(obj).is(':checked'))
                {
                    args[$(obj).attr('data-value')]++;
                }
            });
           
           $('select').each(function (index, obj) {
               if ($(obj).is(':visible')) {
                   args[$(obj).val()]++;
               }
            });

            $.ajax({
                url: "EclipseService.asmx/AddInfluenceAndPopulate",
                data: JSON.stringify(args), dataType: "json", type: "POST", contentType: 'application/json; charset=utf-8',
                success: function (data) {
                    var model = data["d"];
                    ProcessModel(model);
                }
            });

            return false;
        });


    }

    $(document).ready(function () {
  

 

        var args = { x: _lastHex.AxialCoordinates.X, y: _lastHex.AxialCoordinates.Y };
        $.ajax({
            url: "EclipseService.asmx/GetAddPopUI",
            data: JSON.stringify(args), dataType: "json", type: "POST", contentType: 'application/json; charset=utf-8',
            success: function (data) {
                var model = data["d"];
                ProcessModel(model);
            }
        });



       // alert(_lastHex.AxialCoordinates.X);
        $('#choose-pop-modal').modal();

        
    });
</script>
