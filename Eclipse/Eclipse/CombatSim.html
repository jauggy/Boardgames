


<div id="combat-sim-modal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog" style="width:100%">
        <div class="modal-content">

            <div class="modal-body ">
                <nav class="navbar navbar-inverse" role="navigation">
                    <div class="container-fluid">

                        <div class="nav navbar-nav navbar-left" style="min-width:160px">
                            <span id="brand" class="navbar-brand">Combat Simulator</span>

                        </div>



                    </div><!-- /.container-fluid -->
                </nav>

                <!--Body content-->
                <div class="container-fluid">
                    <!--first row-->
                    <div class="row">
                        <div class="col-lg-6" style="border-right: 1px dashed #333;">
                            <label for="add-attacker-buttons">Add ship: </label>

                            <!-- Single drop down button button -->
                            <div id="add-attacker-buttons" class="btn-group">
                                
                                <!--End drop down button-->
                                <div class="btn btn-default attacker">Interceptor</div>
                                <div class="btn btn-default attacker">Cruiser</div>
                                <div class="btn btn-default attacker">Starbase</div>
                                <div class="btn btn-default attacker">Interceptor</div>
                            </div>
                        </div>
                        <div class="col-lg-6">
                            <!-- Single drop down button button -->
                            <div class="btn-group">
                                <!-- Single drop down button button -->
                                <div class="btn-group">
                                    <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
                                        Select player <span class="caret"></span>
                                    </button>
                                    <ul id="sim-list-players" class="dropdown-menu" role="menu">
                                        <li><a href="#">Action</a></li>
                                        <li><a href="#">Another action</a></li>
                                        <li><a href="#">Something else here</a></li>
                                        <li class="divider"></li>
                                        <li><a href="#">Separated link</a></li>
                                    </ul>
                                </div>
                                <!--End drop down button-->

                                <div class="btn-group">
                                    <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
                                        Add Ship <span class="caret"></span>
                                    </button>
                                    <ul id="sim-list-defender-ships" class="dropdown-menu" role="menu">
                                        <li><a href="#">Action</a></li>
                                        <li><a href="#">Another action</a></li>
                                        <li><a href="#">Something else here</a></li>
                                        <li class="divider"></li>
                                        <li><a href="#">Separated link</a></li>
                                    </ul>
                                </div>  <!--End drop down button-->
                                <button class="btn btn-default clear defender">Clear Ships</button>
                            </div>


                        </div>
                    </div>
                    <div class="row">
                        <div class="col-lg-6" style="border-right: 1px dashed #333;">
                           

                            <!-- Single drop down button button -->
                            <div class="btn-group">
                                <div class=" btn-group">
                                    <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
                                        Add Ship <span class="caret"></span>
                                    </button>
                                    <ul id="sim-list-attacker-ships" class="dropdown-menu" role="menu">
                                        <li><a href="#">Action</a></li>
                                        <li><a href="#">Another action</a></li>
                                        <li><a href="#">Something else here</a></li>
                                        <li class="divider"></li>
                                        <li><a href="#">Separated link</a></li>
                                    </ul>
                                </div>
                                <!--End drop down button-->
                                <div class="btn btn-default clear attacker">Clear Ships</div>
                            </div>
                            </div>
                        <div class="col-lg-6">
                            <!-- Single drop down button button -->
                            <div class="btn-group">
                                <!-- Single drop down button button -->
                                <div class="btn-group">
                                    <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
                                        Select player <span class="caret"></span>
                                    </button>
                                    <ul id="sim-list-players" class="dropdown-menu" role="menu">
                                        <li><a href="#">Action</a></li>
                                        <li><a href="#">Another action</a></li>
                                        <li><a href="#">Something else here</a></li>
                                        <li class="divider"></li>
                                        <li><a href="#">Separated link</a></li>
                                    </ul>
                                </div>
                                <!--End drop down button-->

                                <div class="btn-group">
                                <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
                                    Add Ship <span class="caret"></span>
                                </button>
                                <ul id="sim-list-defender-ships" class="dropdown-menu" role="menu">
                                    <li><a href="#">Action</a></li>
                                    <li><a href="#">Another action</a></li>
                                    <li><a href="#">Something else here</a></li>
                                    <li class="divider"></li>
                                    <li><a href="#">Separated link</a></li>
                                </ul>
                                </div>  <!--End drop down button-->
                                <button class="btn btn-default clear defender">Clear Ships</button>
                            </div>
                          
                            
                        </div>
                    </div>

                    <!--new row-->
                    <div class="row">
                        <div class="col-lg-6">
                            <span> Your Ships</span>
                            
                        </div>
                        <div class="col-lg-6">
                            <span id="sim-defender-heading">Blue OrionShips</span>
                            
                        </div>
                    </div>
                    <!--Next row-->
                    <div class="row">
                        <div class="col-lg-6">
                            <ul id="sim-attacker-ships" class="list-inline"></ul>
                        </div>
                        <div class="col-lg-6">
                          
                                <ul  id="sim-defender-ships" class="list-inline"></ul>
              
                        </div>
                    </div>
                </div>

            </div>
            <div class="modal-footer">
                <button id="btn-populate" class="btn btn-primary pull-left">Add influence and populate</button>
                <button class="btn btn-default">Add influence only</button>
                <button class="btn btn-default">No influence</button>
            </div>
        </div>
    </div>

</div>


<script type="text/javascript">
    var _defenderShips = [];
    var _attackerShips = [];
    var _attackerDescriptions; //format will be description['interceptor'] = descr....
    var _defenderDescriptions;

    function ChangeDefender(name) {
        debugger;
        var args = { name: name };
        $.ajax({
            url: "EclipseService.asmx/SetCombatSimDefender",
            data: JSON.stringify(args), dataType: "json", type: "POST", contentType: 'application/json; charset=utf-8',
            success: CombatSimUICallback

        });
    }
        
    function ClearShips() {
        //on change player and first start
        ClearAttackerShips();
        ClearDefenderShips();
    }

    function ClearAttackerShips() {
        $('#sim-attacker-ships').empty();
        _attackerShips = [];
    }

    function ClearDefenderShips() {
        $('#sim-defender-ships').empty();
        _defenderShips = [];
    }

    function CombatSimUICallback(data) {
        var model = data["d"];
        var html = "";

        _attackerDescriptions = {};
        _defenderDescriptions = {};
        for (var i = 0; i < model.AttackerShipSelection.length; i++) {
            var shipname =  model.AttackerShipSelection[i].Name ;
            html += '<li><a  href="javascript:void(0)">' + shipname + '</a></li>';
            _attackerDescriptions[shipname] = model.AttackerShipSelection[i].Description;
        }
        $('#sim-list-attacker-ships').html(html);

        html = "";

        for (var i = 0; i < model.DefenderShipSelection.length; i++) {
            debugger;
            var shipname = model.DefenderShipSelection[i].Name;
            html += '<li><a href="javascript:void(0)">' + shipname + '</a></li>';
            _defenderDescriptions[shipname] = model.DefenderShipSelection[i].Description;
        }
        $('#sim-list-defender-ships').html(html);

        $('#sim-defender-heading').html(model.Enemy.Name + ' Ships');

        html = ""
        for (var i = 0; i < model.DefenderNameSelection.length; i++) {
            html += '<li><a href="javascript:void(0)">' + model.DefenderNameSelection[i] + '</a></li>';
        }

        $('#sim-list-players').html(html);
       
        

    }


    $(document).ready(function(){
            var args = {};
             $.ajax({
             url: "EclipseService.asmx/GetCombatSimUI",
             data: JSON.stringify(args),             dataType: "json",             type: "POST",             contentType: 'application/json; charset=utf-8',
             success: CombatSimUICallback
                
             });

             $('#combat-sim-modal').modal();
             $('#sim-list-players').on('click', 'a', function (event) {
                 
                 ChangeDefender($(this).text());
                 ClearShips();
                 return false;
             });



        //click event add defender ship
             $('#sim-list-defender-ships').on('click', 'a', function (event) {
                 var html = '<li><span class="label label-default">' + $(this).text() + '</span></li>';
                 _defenderShips.push($(this).text());
                 var shipName = $(this).text();
                 $('#sim-defender-ships').append(html);

                     $('#sim-defender-ships').find('span').last().popover({
                         placement: 'top',
                         html: true,
                         trigger: 'hover',
                         content: function (e) {
                             debugger;
                             return '<div style="width:300px">'+_defenderDescriptions[shipName]+'</div>';

                         }
                     });
     

               //  event.stopPropagation();
             });


        //click event add attacker ship
             $('#sim-list-attacker-ships').on('click', 'a', function (event) {
                 var html = '<li><span class="label label-default">' + $(this).text() + '</span></li>';
                 _attackerShips.push($(this).text());
                 var shipName = $(this).text();
                 $('#sim-attacker-ships').append(html);

                 $('#sim-attacker-ships').find('span').last().popover({
                     placement: 'right',
                     html: true,
                     trigger: 'hover',
                     content: function (e) {
                         debugger;
                         return '<div style="width:300px">' + _attackerDescriptions[shipName] + '</div>';

                     }
                 });
             });

             $('#combat-sim-modal').find('.clear').click(function (event) {
                 if($(this).hasClass('attacker'))
                 {
                     ClearAttackerShips();
                 }
                 if($(this).hasClass('defender'))
                 {
                     ClearDefenderShips();
                 }
                 return false;
             });
    });
</script>